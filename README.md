# TransPed-Mutant

ðŸš€ Initialize the development environment

pip install -r requirements.txt
![image](https://github.com/user-attachments/assets/9833758f-335a-420d-9980-48b2cf50f58d)

 This paper will use the PD-1/PD-L1 immune checkpoint as an example to demonstrate the TransPed-Mutant model for designing binding peptide vaccines targeting immune checkpoints.
 
![image](https://github.com/user-attachments/assets/f763e065-c3fe-4960-ad54-10f2094bf954)

![image](https://github.com/user-attachments/assets/94b01f08-fe45-4000-b658-637a31c680cf)

 TransPed is developed by constructing a transformer-based model to predict immune checkpoint protein binding. For vaccine design, the attention scores generated by TransPed are then used to launch the DeepMutant program, which automatically optimizes mutant peptides with higher affinity for the target peptide. The proposed framework can automatically generate potential peptide vaccines for experimenters.

![image](https://github.com/user-attachments/assets/51945514-7d19-45bf-92d7-9057e564966b)

From the figure, it can be observed that there are both similarities and differences in the amino acid composition across the three PD-1 binding peptide datasets (400, 300, and 100 peptides). Alanine shows a relatively high proportion in all datasets, particularly in the 400 and 300 peptide PD-1 binding datasets, where it approaches 0.08. Cysteine has a low proportion across all three datasets, especially in the 100 peptide PD-1 binding dataset, where its proportion is nearly zero. Threonine has a significantly higher proportion in the 400 peptide dataset, close to 0.09, which may suggest that the occurrence frequency of threonine increases in larger datasets. Overall, the proportion of some amino acids varies across datasets of different sizes, with proline (P) and threonine (T) showing the most noticeable changes, indicating that the proportion of these amino acids in PD-1 binding peptides changes as the sample size increases.

![image](https://github.com/user-attachments/assets/9656da55-641f-450d-bfe4-e9564337eecd)

![image](https://github.com/user-attachments/assets/fabbd1b7-35f9-493e-95e0-d866b392262c)

![image](https://github.com/user-attachments/assets/e327e687-d91b-44d6-bacf-9cd6ad9e1adf)

![image](https://github.com/user-attachments/assets/906da586-7191-4ac7-8ada-ab6b79e31575)

![image](https://github.com/user-attachments/assets/2397e3ea-2b20-42c1-ba3a-be8a5c56ae7d)

![image](https://github.com/user-attachments/assets/f8e9c887-23b2-48d7-8eef-f5c693417795)
![image](https://github.com/user-attachments/assets/9aa56ff9-97e9-4e84-9026-e450e492e338)
![image](https://github.com/user-attachments/assets/bf110d2a-97e2-49c5-8c36-109e163bc99d)

Taking the Y68 and H98 binding sites as examples, we compared the experimentally determined 3D structure of PD-1/PD-L1 with the attention map from the sample. We mutated the binding peptide VFNWGHFQE simulated for PD-L1. As shown in the figure, the glycine (G) and asparagine (N) residue positions have lower scores, so the model prioritized and mutated these sites with high negative contributions, resulting in the mutant peptide VFAWLHFQE.

![image](https://github.com/user-attachments/assets/22221b2a-b5d3-4473-a531-22da5e115d4a)
![image](https://github.com/user-attachments/assets/29a14c1f-576a-48b7-a6d2-24a744b22702)
![image](https://github.com/user-attachments/assets/f0df9e27-ba3a-4175-9613-f32cabad51ee)

The image above displays the performance metrics of the model on the independent test set. AUC reflects the model's ability to distinguish between positive and negative samples, with values closer to 1 indicating better performance. Accuracy represents the proportion of correct predictions out of all predictions made. MCC is used to assess the performance of binary classification models, with higher values indicating better predictive effectiveness, particularly when dealing with imbalanced datasets. F1 Score reflects the balance between precision and recall, making it especially useful for handling imbalanced data. For predicting the binding capabilities of specific protein types (such as PD-1 and PD-L1), our model shows a clear performance advantage over other models on the independent test set, achieving an AUC value of 0.92. However, this advantage is not as pronounced in the external test set.
